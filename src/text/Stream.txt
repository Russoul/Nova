
Î“ âŠ¦ A type
-----------------
Î“ âŠ¦ Stream A type

Î“ âŠ¦ s : Stream A
------------------------
Î“ âŠ¦ s.head : A

Î“ âŠ¦ s : Stream A
------------------------
Î“ âŠ¦ s.tail : Stream A

Î“ âŠ¦ X type
Î“ âŠ¦ f : X â†’ A â¨¯ X
Î“ âŠ¦ t : X
-------------------------------
Î“ âŠ¦ Stream-intro f t : Stream A

    (Stream-intro f t).head = (f t).Ï€â‚
    (Stream-intro f t).tail = Stream-intro f (f t).Ï€â‚‚

Î“ âŠ¦ f : X â†’ Stream A
Î“ âŠ¦ h : X â†’ A
Î“ âŠ¦ t : X â†’ Stream A
Î“ âŠ¦ (A â¨¯ f) âˆ˜ (h, t) â‰¡ (.head, .tail) âˆ˜ f
-----------------------------------------
Î“ âŠ¦ f â‰¡ Stream-intro (h, t)

R : Stream A â†’ Stream A â†’ ğ•Œ
R-head : (xs, ys : Stream A) â†’ R xs ys â†’ xs.head â‰¡ ys.head
R-tail : (xs, ys : Stream A) â†’ R xs ys â†’ R xs.tail ys.tail
-----------------------------------------------
coâ‚ : ((xs, ys : Stream A) â¨¯ R xs ys) â†’ Stream A
coâ‚ (xs, ys, h) = xs

coâ‚-helper : ((xs, ys : Stream A) â¨¯ R xs ys) â†’ A â¨¯ ((xs, ys : Stream A) â¨¯ R xs ys)
coâ‚-helper (xs, ys, h) = (xs.head, xs.tail, ys.tail, R-tail xs ys h)

coâ‚‚ : ((xs, ys : Stream A) â¨¯ R xs ys) â†’ Stream A
coâ‚‚ (xs, ys, h) = ys

coâ‚‚-helper : ((xs, ys : Stream A) â¨¯ R xs ys) â†’ A â¨¯ ((xs, ys : Stream A) â¨¯ R xs ys)
coâ‚‚-helper (xs, ys, h) = (xs.head, xs.tail, ys.tail, R-tail xs ys h)

(A â¨¯ coâ‚) âˆ˜ coâ‚-helper = (.head, .tail) âˆ˜ coâ‚
<=>
(xs ys : Stream A) (h : R xs ys) âŠ¦
  ((A â¨¯ coâ‚) âˆ˜ coâ‚-helper) (xs, ys, h) = ((.head, .tail) âˆ˜ coâ‚) (xs, ys, h)
<=>
(xs ys : Stream A) (h : R xs ys) âŠ¦
  (A â¨¯ coâ‚) (xs.head, xs.tail, ys.tail, R-tail xs ys h) = (.head, .tail) xs
<=>
(xs ys : Stream A) (h : R xs ys) âŠ¦
  (xs.head, xs.tail) = (xs.head, xs.tail)
<=>
ğŸ™

//hence coâ‚ is a co-algebra hom into final co-algebra

(A â¨¯ coâ‚‚) âˆ˜ coâ‚‚-helper = (.head, .tail) âˆ˜ coâ‚‚
<=>
(xs ys : Stream A) (h : R xs ys) âŠ¦
  ((A â¨¯ coâ‚‚) âˆ˜ coâ‚‚-helper) (xs, ys, h) = ((.head, .tail) âˆ˜ coâ‚‚) (xs, ys, h)
<=>
(xs ys : Stream A) (h : R xs ys) âŠ¦
  (A â¨¯ coâ‚‚) (xs.head, xs.tail, ys.tail, R-tail xs ys h) = (.head, .tail) ys
<=>
(xs ys : Stream A) (h : R xs ys) âŠ¦
  (xs.head, ys.tail) = (ys.head, ys.tail)
<=>
(xs ys : Stream A) (h : R xs ys) âŠ¦
  (ys.head, ys.tail) = (ys.head, ys.tail)
<=>
ğŸ™

//hence coâ‚‚ is a co-algebra hom into final co-algebra

//By initiality of Stream, coâ‚ = coâ‚‚:

coâ‚ â‰¡ coâ‚‚ : ((xs, ys : Stream A) â¨¯ R xs ys) â†’ A â¨¯ ((xs, ys : Stream A) â¨¯ R xs ys)
<=>
(xs ys : Stream A) (h : R xs ys) âŠ¦
  coâ‚ (xs, ys, h) â‰¡ coâ‚‚ (xs, ys, h)
<=>
(xs ys : Stream A) (h : R xs ys) âŠ¦
  xs â‰¡ ys

//Can we show that:

(hâ‚€, hâ‚ : R xs ys) âŠ¦ hâ‚€ â‰¡ hâ‚

//I don't think we can, so we need an extra assumption
// isProp (R xs ys)
// for (xs â‰¡ ys) â‰… R xs ys
