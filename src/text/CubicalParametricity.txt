
r : ğˆ
(i : ğˆ) âŠ¦ A type
(i : ğˆ) (x : A) âŠ¦ B type
M : A(r/i)
(xâ‚€ : A(0/i)) âŠ¦ Nâ‚€ : B(0/i, xâ‚€/x)
(xâ‚ : A(1/i)) âŠ¦ Nâ‚ : B(1/i, xâ‚/x)
(xâ‚€ : A(0/i)) (xâ‚ : A(1/i)) (x : Bridge (i. A) xâ‚€ xâ‚) âŠ¦ N : Bridge (i. B(x i)) Nâ‚€ Nâ‚
------------------------------------------------------------------------------------
extent r M x.Nâ‚€ x.Nâ‚ xâ‚€.xâ‚.x.N : B(r/i, M/x)

extent 0 M x.Nâ‚€ x.Nâ‚ xâ‚€.xâ‚.x.N = Nâ‚€(M/xâ‚€) : B(0/i, M/x)
extent 1 M x.Nâ‚€ x.Nâ‚ xâ‚€.xâ‚.x.N = Nâ‚(M/xâ‚) : B(1/i, M/x)
extent i M x.Nâ‚€ x.Nâ‚ xâ‚€.xâ‚.x.N = N(M(0/i)/xâ‚€, M(1/i)/xâ‚, (i â†¦ M)/x) i : B(i/i, M/x)

Bridge (i. (x : A) â†’ B) Fâ‚€ Fâ‚
â‰ƒ
(xâ‚€ : A(0/i)) (xâ‚ : A(1/i)) (x : Bridge (i. A) xâ‚€ xâ‚) â†’ Bridge (i. B(x i)) (Fâ‚€ xâ‚€) (Fâ‚ xâ‚)
âˆ
=>) to Î± xâ‚€ xâ‚ x i = Î± i (x i)
<=) from Î± i x = extent i x (xâ‚€. Fâ‚€ xâ‚€) (xâ‚. Fâ‚ xâ‚) (xâ‚€.xâ‚.x. Î± xâ‚€ xâ‚ x)
><) (Î± : Bridge (i. (x : A) â†’ B) Fâ‚€ Fâ‚) âŠ¦
        (i x â†¦ extend i x (xâ‚€. Fâ‚€ xâ‚€) (xâ‚. Fâ‚ xâ‚) (xâ‚€.xâ‚.x. (xâ‚€ xâ‚ x i â†¦ Î± i (x i)) xâ‚€ xâ‚ x)) = Î±
    <=>
    (i : ğˆ) (Î± : Bridge (i. (x : A) â†’ B) Fâ‚€ Fâ‚) âŠ¦
        (i x â†¦ extend i x (xâ‚€. Fâ‚€ xâ‚€) (xâ‚. Fâ‚ xâ‚) (xâ‚€.xâ‚.x. (xâ‚€ xâ‚ x i â†¦ Î± i (x i)) xâ‚€ xâ‚ x)) i = Î± i
    <=>
    (i : ğˆ) (Î± : Bridge (i. (x : A) â†’ B) Fâ‚€ Fâ‚) (x : A) âŠ¦
        (i x â†¦ extend i x (xâ‚€. Fâ‚€ xâ‚€) (xâ‚. Fâ‚ xâ‚) (xâ‚€.xâ‚.x. (xâ‚€ xâ‚ x i â†¦ Î± i (x i)) xâ‚€ xâ‚ x)) i x = Î± i x
    <=>
    (i : ğˆ) (Î± : Bridge (i. (x : A) â†’ B) Fâ‚€ Fâ‚) (x : A) âŠ¦
        (extend i x (xâ‚€. Fâ‚€ xâ‚€) (xâ‚. Fâ‚ xâ‚) (xâ‚€.xâ‚.x. (xâ‚€ xâ‚ x i â†¦ Î± i (x i)) xâ‚€ xâ‚ x)) = Î± i x
    <=>
    (i : ğˆ) (Î± : Bridge (i. (x : A) â†’ B) Fâ‚€ Fâ‚) (x : A) âŠ¦
        (extend i x (xâ‚€. Fâ‚€ xâ‚€) (xâ‚. Fâ‚ xâ‚) (xâ‚€.xâ‚.x. (i â†¦ Î± i (x i)))) = Î± i x
    <=>
    (i : ğˆ) (Î± : Bridge (i. (x : A) â†’ B) Fâ‚€ Fâ‚) (x : A) âŠ¦
        (xâ‚€.xâ‚.x. (i â†¦ Î± i (x i)))[i â†¦ x / x] i = Î± i x
    <=>
    (i : ğˆ) (Î± : Bridge (i. (x : A) â†’ B) Fâ‚€ Fâ‚) (x : A) âŠ¦
        ((i â†¦ Î± i ((i â†¦ x) i))) i = Î± i x
    <=>
    (i : ğˆ) (Î± : Bridge (i. (x : A) â†’ B) Fâ‚€ Fâ‚) (x : A) âŠ¦
        (i â†¦ Î± i x) i = Î± i x
    <=>
    (i : ğˆ) (Î± : Bridge (i. (x : A) â†’ B) Fâ‚€ Fâ‚) (x : A) âŠ¦
        Î± i x = Î± i x âœ”
<>) (Î± : (xâ‚€ : A(0/i)) (xâ‚ : A(1/i)) (x : Bridge (i. A) xâ‚€ xâ‚) â†’ Bridge (i. B(x i)) (Fâ‚€ xâ‚€) (Fâ‚ xâ‚)) âŠ¦ to (from Î±) = Î±
    <=>
    (Î± : (xâ‚€ : A(0/i)) (xâ‚ : A(1/i)) (x : Bridge (i. A) xâ‚€ xâ‚) â†’ Bridge (i. B(x i)) (Fâ‚€ xâ‚€) (Fâ‚ xâ‚)) âŠ¦
      to (i x â†¦ extent i x (xâ‚€. Fâ‚€ xâ‚€) (xâ‚. Fâ‚ xâ‚) (xâ‚€.xâ‚.x. Î± xâ‚€ xâ‚ x)) = Î±
    <=>
    (Î± : (xâ‚€ : A(0/i)) (xâ‚ : A(1/i)) (x : Bridge (i. A) xâ‚€ xâ‚) â†’ Bridge (i. B(x i)) (Fâ‚€ xâ‚€) (Fâ‚ xâ‚)) âŠ¦
      (xâ‚€ xâ‚ x i â†¦ (i x â†¦ extent i x (xâ‚€. Fâ‚€ xâ‚€) (xâ‚. Fâ‚ xâ‚) (xâ‚€.xâ‚.x. Î± xâ‚€ xâ‚ x)) i (x i)) = Î±
    <=>
    (Î± : (xâ‚€ : A(0/i)) (xâ‚ : A(1/i)) (x : Bridge (i. A) xâ‚€ xâ‚) â†’ Bridge (i. B(x i)) (Fâ‚€ xâ‚€) (Fâ‚ xâ‚))
    (xâ‚€ : A(0/i))
    (xâ‚ : A(1/i))
    (x : Bridge (i. A) xâ‚€ xâ‚)
      âŠ¦
      (xâ‚€ xâ‚ x i â†¦ (i x â†¦ extent i x (xâ‚€. Fâ‚€ xâ‚€) (xâ‚. Fâ‚ xâ‚) (xâ‚€.xâ‚.x. Î± xâ‚€ xâ‚ x)) i (x i)) xâ‚€ xâ‚ x = Î± xâ‚€ xâ‚ x
    <=>
    (i : ğˆ)
    (Î± : (xâ‚€ : A(0/i)) (xâ‚ : A(1/i)) (x : Bridge (i. A) xâ‚€ xâ‚) â†’ Bridge (i. B(x i)) (Fâ‚€ xâ‚€) (Fâ‚ xâ‚))
    (xâ‚€ : A(0/i))
    (xâ‚ : A(1/i))
    (x : Bridge (i. A) xâ‚€ xâ‚)
      âŠ¦
      (extent i (x i) (xâ‚€. Fâ‚€ xâ‚€) (xâ‚. Fâ‚ xâ‚) (xâ‚€.xâ‚.x. Î± xâ‚€ xâ‚ x)) = Î± xâ‚€ xâ‚ x i
    <=>
    (i : ğˆ)
    (Î± : (xâ‚€ : A(0/i)) (xâ‚ : A(1/i)) (x : Bridge (i. A) xâ‚€ xâ‚) â†’ Bridge (i. B(x i)) (Fâ‚€ xâ‚€) (Fâ‚ xâ‚))
    (xâ‚€ : A(0/i))
    (xâ‚ : A(1/i))
    (x : Bridge (i. A) xâ‚€ xâ‚)
      âŠ¦
      (xâ‚€.xâ‚.x. Î± xâ‚€ xâ‚ x)[i â†¦ x i / x] i = Î± xâ‚€ xâ‚ x i
    <=>
    (i : ğˆ)
    (Î± : (xâ‚€ : A(0/i)) (xâ‚ : A(1/i)) (x : Bridge (i. A) xâ‚€ xâ‚) â†’ Bridge (i. B(x i)) (Fâ‚€ xâ‚€) (Fâ‚ xâ‚))
    (xâ‚€ : A(0/i))
    (xâ‚ : A(1/i))
    (x : Bridge (i. A) xâ‚€ xâ‚)
      âŠ¦
      Î± xâ‚€ xâ‚ x i = Î± xâ‚€ xâ‚ x i âœ”


r : ğˆ
(xâ‚€ : Aâ‚€) (xâ‚ : Aâ‚) âŠ¦ R type
-----------------------------
Gel r Aâ‚€ Aâ‚ xâ‚€.xâ‚.R type
Gel 0 Aâ‚€ Aâ‚ xâ‚€.xâ‚.R = Aâ‚€ type
Gel 1 Aâ‚€ Aâ‚ xâ‚€.xâ‚.R = Aâ‚ type

Mâ‚€ : Aâ‚€
Mâ‚ : Aâ‚
M : R(Mâ‚€, Mâ‚)
-------------------
gel r Mâ‚€ Mâ‚ M : Gel r Aâ‚€ Aâ‚ xâ‚€.xâ‚.R
gel 0 Mâ‚€ Mâ‚ M = Mâ‚€ : Aâ‚€
gel 1 Mâ‚€ Mâ‚ M = Mâ‚ : Aâ‚

(i : ğˆ) âŠ¦ M : Gel i Aâ‚€ Aâ‚ xâ‚€.xâ‚.R
-----------------------
ungel i.M : R(M(0/i), M(1/i))

ungel (i. gel i Mâ‚€ Mâ‚ M) = M : R(Mâ‚€, Mâ‚)

gel r M(0/i) M(1/i) (ungel i.M) = M(r/i) : Gel r Aâ‚€ Aâ‚ xâ‚€.xâ‚.R


-------------- Theorem proving ----------------

Th.
Bridge ğ•Œ A B â‰… (A â†’ B â†’ ğ•Œ)
âˆ
=>) to C aâ‚€ aâ‚ = Bridge (i. C i) aâ‚€ aâ‚
<=) from R i = Gel i A B (xâ‚€.xâ‚. R xâ‚€ xâ‚)
><) i (C : Bridge ğ•Œ A B) âŠ¦ Gel i A B (xâ‚€.xâ‚. Bridge (i. C i) xâ‚€ xâ‚) â‰¡ C i
    //Definitional iso
    =>) f x = ungel (i. x) i
    <=) g x = gel i x(0/i) x(1/i) (i â†¦ x)
    ><) (x : Gel i A B (xâ‚€.xâ‚. Bridge (i. C i) xâ‚€ xâ‚)) âŠ¦
          gel i x(0/i) x(1/i) (ungel (i. x)) â‰¡ x âœ”
    ><) (x : C i) âŠ¦ x â‰¡ x âœ”
><) (R : A â†’ B â†’ ğ•Œ) (a : A) (b : B) âŠ¦ Bridge (i. Gel i A B (xâ‚€.xâ‚. R xâ‚€ xâ‚)) a b â‰¡ R a b
    //Definitional iso
    =>) f x = ungel (i. x i)
    <=) g x i = gel i a b x
    =>) x â‰¡ x âœ”
    <=) x = x âœ”
âˆ


Th.
Bridge (i. (x : A) â¨¯ B) pâ‚€ pâ‚ â‰… (x : Bridge (i. A) pâ‚€.Ï€â‚ pâ‚.Ï€â‚) â¨¯ Bridge (i. B (x i / x)) pâ‚€.Ï€â‚‚ pâ‚.Ï€â‚‚
âˆ
=>) f p = (i â†¦ p i .Ï€â‚, i â†¦ p i .Ï€â‚‚)
<=) g (p, q) = i â†¦ (p i, q i)
><) âœ”
<>) âœ” âˆ



((X : ğ•Œ) â†’ X â†’ X) â‰… ğŸ™

F : ((X : ğ•Œ) â†’ X â†’ X)
-----------------------------
Bridge ((X : ğ•Œ) â†’ X â†’ X) F F

Bridge ((X : ğ•Œ) â†’ X â†’ X) F F
â‰…
(Xâ‚€ Xâ‚ : ğ•Œ) (X : Bridge ğ•Œ Xâ‚€ Xâ‚) â†’ Bridge (i. X i â†’ X i) (F Xâ‚€) (F Xâ‚)
â‰…
(Xâ‚€ Xâ‚ : ğ•Œ) (X : Bridge ğ•Œ Xâ‚€ Xâ‚) (xâ‚€ : Xâ‚€) (xâ‚ : Xâ‚) (x : Bridge (i. X i) xâ‚€ xâ‚) â†’ Bridge (i. X i) (F Xâ‚€ xâ‚€) (F Xâ‚ xâ‚)
â‰…
(Xâ‚€ Xâ‚ : ğ•Œ) (X : Xâ‚€ â†’ Xâ‚ â†’ ğ•Œ) (xâ‚€ : Xâ‚€) (xâ‚ : Xâ‚) (x : Bridge (i. Gel i Xâ‚€ Xâ‚ X) xâ‚€ xâ‚) â†’ Bridge (i. Gel i Xâ‚€ Xâ‚ X) (F Xâ‚€ xâ‚€) (F Xâ‚ xâ‚)
â‰…
(Xâ‚€ Xâ‚ : ğ•Œ) (X : Xâ‚€ â†’ Xâ‚ â†’ ğ•Œ) (xâ‚€ : Xâ‚€) (xâ‚ : Xâ‚) (x : X xâ‚€ xâ‚) â†’ X (F Xâ‚€ xâ‚€) (F Xâ‚ xâ‚)
//We got exactly the theorem we'd get from the usual relational interpretation

//Lemma
p q : Gel i R
-------------
(p = q) â‰ƒ (p(0/i) = q(0/i)) â¨¯ (p(1/i) = q(1/i)) â¨¯ (ungel (i. p) = ungel (i. q))
âˆ
f Î± = coe (j. (p(0/i) = (Î± j)(0/i)) â¨¯ (p(1/i) = (Î± j)(1/i)) â¨¯ (ungel (i. p) = ungel (i. Î± j))) 0 1
          (Refl, Refl, Refl)
g (Î±, Î², Î³) = Refl

//Lemma
R : A â†’ B â†’ ğ•Œ
a : A
b : B
-----------------------------------------------------
((g : Gel i R) â¨¯ (g(0/i) = a) â¨¯ (g(1/i) = b)) â‰… R a b
âˆ
=>) f (Î±, l, r) = ungel (i. Î±)
<=) g r = gel i a b r, *, *
><) (Î± : Gel i R) (p : g(0/i) = a) (q : g(1/i) = b) âŠ¦ g Î± = (ungel (i. Î±), p, q)
    (Î± : Gel i R) (p : g(0/i) = a) (q : g(1/i) = b) âŠ¦ g (ungel (i. Î±)) = (Î±, p, q)
    (Î± : Gel i R) (p : g(0/i) = a) (q : g(1/i) = b) âŠ¦ (gel i a b (ungel (i. Î±)), *, *) = (Î±, p, q)
    (Î± : Gel i R) (p : g(0/i) = a) (q : g(1/i) = b) âŠ¦ gel i a b (ungel (i. Î±)) = Î± âœ”
<>) (r : R a b) âŠ¦ f (g r) = r
    (r : R a b) âŠ¦ (ungel (i. gel i a b r) = r âœ” âˆ


R : Pointed â†’ Pointed â†’ ğ•Œ
r : R pâ‚€ pâ‚
----------------------------
pâ‚€ ~ pâ‚

i â†¦ (gel i pâ‚€ pâ‚ r : Gel i R) : Bridge (i. Gel i R) pâ‚€ pâ‚

Pointed = (A : ğ•Œ) â¨¯ A
((P : Pointed) â†’ P.Ï€â‚) â‰… ğŸ™
âˆ
It's enough to show that
for every F : (P : Pointed) â†’ P.Ï€â‚
((X, x) â†¦ x) â‰¡ F
which is equivalent to
(p : Pointed) âŠ¦ F p â‰¡ p.Ï€â‚‚

the following type is inhabited:
Bridge ((P : Pointed) â†’ P.Ï€â‚) F F
â‰… //By characterisation of Bridges in dependent product
  //Notation (aâ‚€ ~ aâ‚) â‰” Bridge (i. _) aâ‚€ aâ‚
(pâ‚€ pâ‚ : Pointed) (p : pâ‚€ ~ pâ‚) â†’ Bridge (i. (p i).Ï€â‚) (F pâ‚€) (F pâ‚)
//Take pâ‚ â‰” (ğŸ™, ())
(pâ‚€ : Pointed) (p : pâ‚€ ~ (ğŸ™, ())) â†’ Bridge (i. (p i).Ï€â‚) (F pâ‚€) (F (ğŸ™, ()))
â‰… //By characterisation of Bridges in dependent sum
(pâ‚€ : Pointed) (p : (X : pâ‚€.Ï€â‚ ~ ğŸ™) â¨¯ Bridge (i. X i) pâ‚€.Ï€â‚‚ ()) â†’ Bridge (i. (p i).Ï€â‚) (F pâ‚€) (F (ğŸ™, ()))
â‰…
(pâ‚€ : Pointed) (X : pâ‚€.Ï€â‚ ~ ğŸ™) (q : Bridge (i. X i) pâ‚€.Ï€â‚‚ ()) â†’ Bridge (i. X i) (F pâ‚€) (F (ğŸ™, ()))
â‰… //By characterisation of Bridge in the universe
(pâ‚€ : Pointed) (X : pâ‚€.Ï€â‚ â†’ ğŸ™ â†’ ğ•Œ) (q : Bridge (i. Gel i X) pâ‚€.Ï€â‚‚ ()) â†’ Bridge (i. Gel i X) (F pâ‚€) (F (ğŸ™, ()))
let X : pâ‚€.Ï€â‚ â†’ ğŸ™ â†’ ğ•Œ
    X x _ = (x â‰¡ pâ‚€.Ï€â‚‚)
(pâ‚€ : Pointed) (q : Bridge (i. Gel i X) pâ‚€.Ï€â‚‚ ()) â†’ Bridge (i. Gel i X) (F pâ‚€) (F (ğŸ™, ()))
â‰… //By charactersation of Bridge-in-Gel
(pâ‚€ : Pointed) (q : X pâ‚€.Ï€â‚‚ ()) â†’ X (F pâ‚€) (F (ğŸ™, ()))
//By definition
(pâ‚€ : Pointed) (q : pâ‚€.Ï€â‚‚ â‰¡ pâ‚€.Ï€â‚‚) â†’ X (F pâ‚€) (F (ğŸ™, ()))
//Assume we have UIP at pâ‚€.Ï€â‚
(pâ‚€ : Pointed) â†’ X (F pâ‚€) (F (ğŸ™, ()))
//rename
(p : Pointed) â†’ X (F p) (F (ğŸ™, ()))
//Substitute X
(p : Pointed) â†’ F p â‰¡ p.Ï€â‚‚
//But this is exactly what we needed to show âˆ



