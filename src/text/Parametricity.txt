Main idea:
relationally parametric functions preserve all relations!

//
Want to show that:
((X : ğ•Œ) â†’ X â†’ X) â‰… ğŸ™
âˆ
=>) const ()
<=) const id
<>) trivial
><) f : (X : ğ•Œ) â†’ X â†’ X
    f â‰¡ id
    (X : ğ•Œ) (x : X) âŠ¦ f X x â‰¡ x
    RÌ… : ğŸ™ â†’ X â†’ ğ•Œ
    RÌ… () y = x â‰¡ y
    //Using parametricity we have the following truthful fact:
    (A : ğ•Œ) (B : ğ•Œ) (R : Rel A B) (a : A) (b : B) (r : R a b) â†’ R (Î± A a) (Î² B b)
    //Take A â‰” ğŸ™
    (B : ğ•Œ) (R : Rel ğŸ™ B) (a : ğŸ™) (b : B) (r : R a b) â†’ R (Î± ğŸ™ a) (Î² B b)
    (B : ğ•Œ) (R : Rel ğŸ™ B) (b : B) (r : R () b) â†’ R (Î± ğŸ™ ()) (Î² B b)
    //Rename B to X
    (X : ğ•Œ) (R : Rel ğŸ™ X) (x : X) (r : R () x) â†’ R (Î± ğŸ™ ()) (Î² X x)
    //Take R â‰” RÌ…
    (X : ğ•Œ) (x : X) (r : RÌ… () x) â†’ RÌ… (Î± ğŸ™ ()) (Î² X x)
    //By definition
    (X : ğ•Œ) (x : X) (r : x â‰¡ x) â†’ Î² X x â‰¡ x
    //Contract
    (X : ğ•Œ) (x : X) â†’ Î² X x â‰¡ x
    //Take Î± = Î² = f
    (X : ğ•Œ) (x : X) â†’ f X x â‰¡ x
    //This is exactly what we wanted to prove âˆ


//Define:
ğ”¹ = (X : ğ•Œ) â†’ X â†’ X â†’ X
//Show that Bool â‰… ğ”¹
âˆ
=>) to False = X t f â†¦ f
    to True = X t f â†¦ t
<=) from k = k Bool True False
><) from . to = id
    (x : Bool) âŠ¦ from (to x) = x : Bool
    *) from (to True) = True
       from (X t f â†¦ t) = True
       True = True âœ”

    *) from (to False) = False
       from (X t f â†¦ f) = False
       False = False âœ”
<>) to . from = id
    (b : ğ”¹) âŠ¦ to (from b) = b : ğ”¹
    (b : ğ”¹) âŠ¦ to (from b) = b : (X : ğ•Œ) â†’ X â†’ X â†’ X
    (k : ğ”¹) (A : ğ•Œ) (t f : A) âŠ¦ to (k Bool True False) A t f = k A t f : A
    //Define a relation
                                RÌ… : Bool â†’ A â†’ ğ•Œ
                                RÌ… b a = to b A t f â‰¡ a

   âŸ¦(X : ğ•Œ) â†’ X â†’ X â†’ XâŸ§(f, g)
   =
   (A B : ğ•Œ) (R : A â†’ B â†’ ğ•Œ) â†’ âŸ¦R â†’ R â†’ RâŸ§(f A, g B)
   =
   (A B : ğ•Œ) (R : A â†’ B â†’ ğ•Œ) (aâ‚€ : A) (bâ‚€ : B) (râ‚€ : R aâ‚€ bâ‚€) â†’ âŸ¦R â†’ RâŸ§(f A aâ‚€, g B bâ‚€)
   =
   (A B : ğ•Œ) (R : A â†’ B â†’ ğ•Œ) (aâ‚€ : A) (bâ‚€ : B) (râ‚€ : R aâ‚€ bâ‚€) (aâ‚ : A) (bâ‚ : B) (râ‚ : R aâ‚ bâ‚) â†’ R (f A aâ‚€ aâ‚) (g B bâ‚€ bâ‚)
   //Take A â‰” Bool
   (B : ğ•Œ) (R : Bool â†’ B â†’ ğ•Œ) (aâ‚€ : Bool) (bâ‚€ : B) (râ‚€ : R aâ‚€ bâ‚€) (aâ‚ : Bool) (bâ‚ : B) (râ‚ : R aâ‚ bâ‚) â†’ R (f Bool aâ‚€ aâ‚) (g B bâ‚€ bâ‚)
   //Take B â‰” A
   (A : ğ•Œ) (R : Bool â†’ A â†’ ğ•Œ) (aâ‚€ : Bool) (bâ‚€ : A) (râ‚€ : R aâ‚€ bâ‚€) (aâ‚ : Bool) (bâ‚ : A) (râ‚ : R aâ‚ bâ‚) â†’ R (f Bool aâ‚€ aâ‚) (g A bâ‚€ bâ‚)
   //Reorder
   (A : ğ•Œ) (bâ‚€ bâ‚ : A) (aâ‚€ aâ‚ : Bool) (R : Bool â†’ A â†’ ğ•Œ) (râ‚€ : R aâ‚€ bâ‚€) (râ‚ : R aâ‚ bâ‚) â†’ R (f Bool aâ‚€ aâ‚) (g A bâ‚€ bâ‚)
   //rename bâ‚€ â‡ t, bâ‚ â‡ f
   (A : ğ•Œ) (t f : A) (aâ‚€ aâ‚ : Bool) (R : Bool â†’ A â†’ ğ•Œ) (râ‚€ : R aâ‚€ t) (râ‚ : R aâ‚ f) â†’ R (f Bool aâ‚€ aâ‚) (g A t f)
   //Take R â‰” RÌ…
   (A : ğ•Œ) (t f : A) (aâ‚€ aâ‚ : Bool) (râ‚€ : to aâ‚€ A t f â‰¡ t) (râ‚ : to aâ‚ A t f â‰¡ f) â†’  to (f Bool aâ‚€ aâ‚) A t f â‰¡ g A t f
   â‰…
   (A : ğ•Œ) (t f : A) â†’ to (f Bool True False) A t f â‰¡ g A t f

   (k : ğ”¹) (A : ğ•Œ) (t f : A) â†’ to (f Bool True False) A t f â‰¡ g A t f
   //pick g â‰” k
   (k : ğ”¹) (A : ğ•Œ) (t f : A) â†’ to (f Bool True False) A t f â‰¡ k A t f
   //pick f â‰” k
   (k : ğ”¹) (A : ğ•Œ) (t f : A) â†’ to (k Bool True False) A t f â‰¡ k A t f
   //This is exactly what we wanted to prove âˆ





âŸ¦(X : ğ•Œ) â†’ X â†’ XâŸ§(f, f)
=
(A : ğ•Œ) (B : ğ•Œ) (r : Rel A B) â†’ âŸ¦X â†’ XâŸ§(f A, f B)
=
(A : ğ•Œ) (B : ğ•Œ) (R : Rel A B) (a : A) (b : B) (r : R a b) â†’ âŸ¦XâŸ§(f A a, f B b)
=
(A : ğ•Œ) (B : ğ•Œ) (R : Rel A B) (a : A) (b : B) (r : R a b) â†’ R (f A a) (f B b)


(f : ((X : ğ•Œ) â†’ X â†’ X)) âŠ¦
  (A : ğ•Œ) (a : A) â†’ f A a = a


  (A : ğ•Œ) (R : Rel A A) (aâ‚€ : A) (aâ‚ : A) (r : R aâ‚€ aâ‚) â†’ R (f A aâ‚€) (f A aâ‚)
  // R x y = f A x â‰¡ y
  (A : ğ•Œ) (aâ‚€ : A) (aâ‚ : A) (r : f A aâ‚€ â‰¡ aâ‚) â†’ f A aâ‚ = f A aâ‚


typeRel : ğ•Œ â†’ ğ•Œ â†’ ğ•Œ
typeRel A B = A â†’ B â†’ ğ•Œ

funRel : (A â†’ B) â†’ (A â†’ B) â†’ Prop
funRel f g = (xâ‚€ xâ‚ : A) â†’ A xâ‚€ xâ‚ â†’ B (f xâ‚€) (g xâ‚)

depRel : ((x : A) â†’ B) â†’ ((x : A) â†’ B) â†’ Prop
depRel f g = (xâ‚€ xâ‚ : A) â†’ (x : A xâ‚€ xâ‚) â†’ B x (f xâ‚€) (g xâ‚)

pairRel : (A â¨¯ B) â†’ (A â¨¯ B) â†’ Prop
pairRel p q = A p.Ï€â‚ q.Ï€â‚ â¨¯ B p.Ï€â‚‚ q.Ï€â‚‚

sigmaRel : ((x : A) â¨¯ B) â†’ ((x : A) â¨¯ B) â†’ Prop
sigmaRel p q = (r : A p.Ï€â‚ q.Ï€â‚) â¨¯ B r p.Ï€â‚‚ q.Ï€â‚‚

f xâ‚€ : B xâ‚€
g xâ‚ : B xâ‚

âŸ¦(X : ğ•Œ) â†’ X â†’ XâŸ§(f, g)
=
(A B : ğ•Œ) (R : A â†’ B â†’ ğ•Œ) â†’ âŸ¦X â†’ XâŸ§(R, f A, f B)
=
(A B : ğ•Œ) (R : A â†’ B â†’ ğ•Œ) (a : A) (b : B) (r : A = B) â†’ R (f A a) (f B b)



(âˆ€A. âˆ€B. A â¨¯ B â†’ A) â‰… ğŸ™
//
...
f : âˆ€A. âˆ€B. A â¨¯ B â†’ A
(A B : ğ•Œ) (p : A â¨¯ B) âŠ¦ f A B p = p.Ï€â‚

âŸ¦âˆ€A. âˆ€B. A â¨¯ B â†’ AâŸ§(f, g)
=
(Aâ‚€ : ğ•Œ) (Aâ‚ : ğ•Œ) (A : Aâ‚€ â†’ Aâ‚ â†’ ğ•Œ) â†’ âŸ¦âˆ€B. A â¨¯ B â†’ AâŸ§(f Aâ‚€, g Aâ‚)
=
(Aâ‚€ : ğ•Œ) (Aâ‚ : ğ•Œ) (A : Aâ‚€ â†’ Aâ‚ â†’ ğ•Œ) (Bâ‚€ : ğ•Œ) (Bâ‚ : ğ•Œ) (B : Bâ‚€ â†’ Bâ‚ â†’ ğ•Œ) â†’ âŸ¦A â¨¯ B â†’ AâŸ§(f Aâ‚€ Bâ‚€, g Aâ‚ Bâ‚)
=
(Aâ‚€ : ğ•Œ) (Aâ‚ : ğ•Œ) (A : Aâ‚€ â†’ Aâ‚ â†’ ğ•Œ) (Bâ‚€ : ğ•Œ) (Bâ‚ : ğ•Œ) (B : Bâ‚€ â†’ Bâ‚ â†’ ğ•Œ)
(pâ‚€ : Aâ‚€ â¨¯ Bâ‚€) (pâ‚ : Aâ‚ â¨¯ Bâ‚) (p : âŸ¦A â¨¯ BâŸ§(pâ‚€, pâ‚)) â†’ âŸ¦AâŸ§(f Aâ‚€ Bâ‚€ pâ‚€, g Aâ‚ Bâ‚ pâ‚)
=
(Aâ‚€ : ğ•Œ) (Aâ‚ : ğ•Œ) (A : Aâ‚€ â†’ Aâ‚ â†’ ğ•Œ) (Bâ‚€ : ğ•Œ) (Bâ‚ : ğ•Œ) (B : Bâ‚€ â†’ Bâ‚ â†’ ğ•Œ)
(pâ‚€ : Aâ‚€ â¨¯ Bâ‚€) (pâ‚ : Aâ‚ â¨¯ Bâ‚) (p : âŸ¦AâŸ§(pâ‚€.Ï€â‚, pâ‚.Ï€â‚) â¨¯ âŸ¦BâŸ§(pâ‚€.Ï€â‚‚, pâ‚.Ï€â‚‚)) â†’ âŸ¦AâŸ§(f Aâ‚€ Bâ‚€ pâ‚€, g Aâ‚ Bâ‚ pâ‚)
=
(Aâ‚€ : ğ•Œ) (Aâ‚ : ğ•Œ) (A : Aâ‚€ â†’ Aâ‚ â†’ ğ•Œ) (Bâ‚€ : ğ•Œ) (Bâ‚ : ğ•Œ) (B : Bâ‚€ â†’ Bâ‚ â†’ ğ•Œ)
(pâ‚€ : Aâ‚€ â¨¯ Bâ‚€) (pâ‚ : Aâ‚ â¨¯ Bâ‚) (p : A pâ‚€.Ï€â‚ pâ‚.Ï€â‚ â¨¯ B pâ‚€.Ï€â‚‚ pâ‚.Ï€â‚‚) â†’ âŸ¦AâŸ§(f Aâ‚€ Bâ‚€ pâ‚€, g Aâ‚ Bâ‚ pâ‚)
=
(Aâ‚€ : ğ•Œ) (Aâ‚ : ğ•Œ) (A : Aâ‚€ â†’ Aâ‚ â†’ ğ•Œ) (Bâ‚€ : ğ•Œ) (Bâ‚ : ğ•Œ) (B : Bâ‚€ â†’ Bâ‚ â†’ ğ•Œ)
(pâ‚€ : Aâ‚€ â¨¯ Bâ‚€) (pâ‚ : Aâ‚ â¨¯ Bâ‚) (p : A pâ‚€.Ï€â‚ pâ‚.Ï€â‚ â¨¯ B pâ‚€.Ï€â‚‚ pâ‚.Ï€â‚‚) â†’ A (f Aâ‚€ Bâ‚€ pâ‚€) (g Aâ‚ Bâ‚ pâ‚)
//pick Aâ‚ â‰” ğŸ™, Bâ‚ â‰” ğŸ™, B _ _ â‰” ğŸ™
=
(A B : ğ•Œ) (p : A â¨¯ B) (R : A â†’ ğŸ™ â†’ ğ•Œ) (p : R p.Ï€â‚ () â¨¯ ğŸ™) â†’ R (f A B p) (g ğŸ™ ğŸ™ ())
//R x _ = x â‰¡ p.Ï€â‚
(A B : ğ•Œ) (p : A â¨¯ B) (p : p.Ï€â‚ â‰¡ p.Ï€â‚) â†’ f A B p â‰¡ p.Ï€â‚
//
(A B : ğ•Œ) (p : A â¨¯ B) â†’ f A B p â‰¡ p.Ï€â‚
//Exactly what we wanted to show!

//Define
Monoid = (A : ğ•Œ) â¨¯ A â¨¯ (A â¨¯ A â†’ A)
//where L are monoid laws
âŸ¦MonoidâŸ§(Mâ‚€, Mâ‚)
=
âŸ¦(A : ğ•Œ) â¨¯ A â¨¯ (A â¨¯ A â†’ A)âŸ§(Mâ‚€, Mâ‚)
=
(A : âŸ¦ğ•ŒâŸ§(Mâ‚€.Ï€â‚, Mâ‚.Ï€â‚)) â¨¯ âŸ¦A â¨¯ (A â¨¯ A â†’ A)âŸ§(Mâ‚€.Ï€â‚‚, Mâ‚.Ï€â‚‚)
=
(A : Mâ‚€.Ï€â‚ â†’ Mâ‚.Ï€â‚ â†’ ğ•Œ) â¨¯ âŸ¦AâŸ§(Mâ‚€.Ï€â‚‚.Ï€â‚, Mâ‚.Ï€â‚‚.Ï€â‚) â¨¯ âŸ¦A â¨¯ A â†’ AâŸ§(Mâ‚€.Ï€â‚‚.Ï€â‚‚, Mâ‚.Ï€â‚‚.Ï€â‚‚)
=
(A : Mâ‚€.Ï€â‚ â†’ Mâ‚.Ï€â‚ â†’ ğ•Œ) â¨¯ A Mâ‚€.Ï€â‚‚.Ï€â‚ Mâ‚.Ï€â‚‚.Ï€â‚ â¨¯ âŸ¦A â¨¯ A â†’ AâŸ§(Mâ‚€.Ï€â‚‚.Ï€â‚‚, Mâ‚.Ï€â‚‚.Ï€â‚‚)
=
(A : Mâ‚€.Ï€â‚ â†’ Mâ‚.Ï€â‚ â†’ ğ•Œ) â¨¯ A Mâ‚€.Ï€â‚‚.Ï€â‚ Mâ‚.Ï€â‚‚.Ï€â‚ â¨¯ ((pâ‚€ : âŸ¦A â¨¯ AâŸ§â‚€) (pâ‚ : âŸ¦A â¨¯ AâŸ§â‚) (p : âŸ¦A â¨¯ AâŸ§(pâ‚€, pâ‚)) â†’ âŸ¦AâŸ§(Mâ‚€.Ï€â‚‚.Ï€â‚‚ pâ‚€, Mâ‚.Ï€â‚‚.Ï€â‚‚ pâ‚))
=
(A : Mâ‚€.Ï€â‚ â†’ Mâ‚.Ï€â‚ â†’ ğ•Œ) â¨¯ A Mâ‚€.Ï€â‚‚.Ï€â‚ Mâ‚.Ï€â‚‚.Ï€â‚ â¨¯
  ((pâ‚€ : Mâ‚€.Ï€â‚ â¨¯ Mâ‚€.Ï€â‚) (pâ‚ : Mâ‚.Ï€â‚ â¨¯ Mâ‚.Ï€â‚) (p : âŸ¦AâŸ§(pâ‚€.Ï€â‚, pâ‚.Ï€â‚) â¨¯ âŸ¦AâŸ§(pâ‚€.Ï€â‚‚, pâ‚.Ï€â‚‚)) â†’ âŸ¦AâŸ§(Mâ‚€.Ï€â‚‚.Ï€â‚‚ pâ‚€, Mâ‚.Ï€â‚‚.Ï€â‚‚ pâ‚))
=
(A : Mâ‚€.Ï€â‚ â†’ Mâ‚.Ï€â‚ â†’ ğ•Œ) â¨¯ A Mâ‚€.Ï€â‚‚.Ï€â‚ Mâ‚.Ï€â‚‚.Ï€â‚ â¨¯
  ((pâ‚€ : Mâ‚€.Ï€â‚ â¨¯ Mâ‚€.Ï€â‚) (pâ‚ : Mâ‚.Ï€â‚ â¨¯ Mâ‚.Ï€â‚) (p : A pâ‚€.Ï€â‚ pâ‚.Ï€â‚ â¨¯ A pâ‚€.Ï€â‚‚ pâ‚.Ï€â‚‚) â†’ A Mâ‚€.Ï€â‚‚.Ï€â‚‚ pâ‚€ Mâ‚.Ï€â‚‚.Ï€â‚‚ pâ‚)


((M : Monoid) â†’ M.Ï€â‚) â‰… ğŸ™
âˆ
...
f : (M : Monoid) â†’ M.Ï€â‚
(M : Monoid) â†’ f M â‰¡ M.Ï€â‚‚.Ï€â‚

âŸ¦(M : Monoid) â†’ M.Ï€â‚âŸ§(f, g)
=
(Mâ‚€, Mâ‚ : Monoid) (M : âŸ¦MonoidâŸ§(Mâ‚€, Mâ‚)) â†’ âŸ¦M.Ï€â‚âŸ§(f Mâ‚€, g Mâ‚)
=
(Mâ‚€, Mâ‚ : Monoid)
(M : (A : Mâ‚€.Ï€â‚ â†’ Mâ‚.Ï€â‚ â†’ ğ•Œ) â¨¯ A Mâ‚€.Ï€â‚‚.Ï€â‚ Mâ‚.Ï€â‚‚.Ï€â‚ â¨¯
  ((pâ‚€ : Mâ‚€.Ï€â‚ â¨¯ Mâ‚€.Ï€â‚) (pâ‚ : Mâ‚.Ï€â‚ â¨¯ Mâ‚.Ï€â‚) (p : A pâ‚€.Ï€â‚ pâ‚.Ï€â‚ â¨¯ A pâ‚€.Ï€â‚‚ pâ‚.Ï€â‚‚) â†’ A Mâ‚€.Ï€â‚‚.Ï€â‚‚ pâ‚€ Mâ‚.Ï€â‚‚.Ï€â‚‚ pâ‚))
â†’ âŸ¦M.Ï€â‚âŸ§(f Mâ‚€, g Mâ‚)
=
(Mâ‚€, Mâ‚ : Monoid)
(M : (A : Mâ‚€.Ï€â‚ â†’ Mâ‚.Ï€â‚ â†’ ğ•Œ) â¨¯ A Mâ‚€.Ï€â‚‚.Ï€â‚ Mâ‚.Ï€â‚‚.Ï€â‚ â¨¯
  ((pâ‚€ : Mâ‚€.Ï€â‚ â¨¯ Mâ‚€.Ï€â‚) (pâ‚ : Mâ‚.Ï€â‚ â¨¯ Mâ‚.Ï€â‚) (p : A pâ‚€.Ï€â‚ pâ‚.Ï€â‚ â¨¯ A pâ‚€.Ï€â‚‚ pâ‚.Ï€â‚‚) â†’ A Mâ‚€.Ï€â‚‚.Ï€â‚‚ pâ‚€ Mâ‚.Ï€â‚‚.Ï€â‚‚ pâ‚))
â†’ M.Ï€â‚ (f Mâ‚€) (g Mâ‚)
â‰…
(Mâ‚€, Mâ‚ : Monoid)
(A : Mâ‚€.Ï€â‚ â†’ Mâ‚.Ï€â‚ â†’ ğ•Œ)
(0 : A Mâ‚€.Ï€â‚‚.Ï€â‚ Mâ‚.Ï€â‚‚.Ï€â‚)
(_+_ : (pâ‚€ : Mâ‚€.Ï€â‚ â¨¯ Mâ‚€.Ï€â‚) (pâ‚ : Mâ‚.Ï€â‚ â¨¯ Mâ‚.Ï€â‚) (p : A pâ‚€.Ï€â‚ pâ‚.Ï€â‚ â¨¯ A pâ‚€.Ï€â‚‚ pâ‚.Ï€â‚‚) â†’ A Mâ‚€.Ï€â‚‚.Ï€â‚‚ pâ‚€ Mâ‚.Ï€â‚‚.Ï€â‚‚ pâ‚)
â†’ A (f Mâ‚€) (g Mâ‚)
//Pick Mâ‚ â‰” Unit
(Mâ‚€ : Monoid)
(A : Mâ‚€.Ï€â‚ â†’ ğŸ™ â†’ ğ•Œ)
(0 : A Mâ‚€.Ï€â‚‚.Ï€â‚ ())
(_+_ : (pâ‚€ : Mâ‚€.Ï€â‚ â¨¯ Mâ‚€.Ï€â‚) (p : A pâ‚€.Ï€â‚ () â¨¯ A pâ‚€.Ï€â‚‚ ()) â†’ A Mâ‚€.Ï€â‚‚.Ï€â‚‚ pâ‚€ ())
â†’ A (f Mâ‚€) (g Unit)
//pick A x () = x â‰¡ Mâ‚€.Ï€â‚‚.Ï€â‚
(Mâ‚€ : Monoid)
(0 : Mâ‚€.Ï€â‚‚.Ï€â‚ â‰¡ Mâ‚€.Ï€â‚‚.Ï€â‚)
(_+_ : (pâ‚€ : Mâ‚€.Ï€â‚ â¨¯ Mâ‚€.Ï€â‚) (p : pâ‚€.Ï€â‚ â‰¡ Mâ‚€.Ï€â‚‚.Ï€â‚ â¨¯ pâ‚€.Ï€â‚‚ â‰¡ Mâ‚€.Ï€â‚‚.Ï€â‚) â†’ (Mâ‚€.Ï€â‚‚.Ï€â‚‚ pâ‚€) â‰¡ Mâ‚€.Ï€â‚‚.Ï€â‚)
â†’ f Mâ‚€ â‰¡ Mâ‚€.Ï€â‚‚.Ï€â‚
â‰…
(Mâ‚€ : Monoid)
(_+_ : (pâ‚€ : Mâ‚€.Ï€â‚ â¨¯ Mâ‚€.Ï€â‚) (p : pâ‚€.Ï€â‚ â‰¡ Mâ‚€.Ï€â‚‚.Ï€â‚ â¨¯ pâ‚€.Ï€â‚‚ â‰¡ Mâ‚€.Ï€â‚‚.Ï€â‚) â†’ (Mâ‚€.Ï€â‚‚.Ï€â‚‚ pâ‚€) â‰¡ Mâ‚€.Ï€â‚‚.Ï€â‚)
â†’ f Mâ‚€ â‰¡ Mâ‚€.Ï€â‚‚.Ï€â‚
â‰…
(Mâ‚€ : Monoid)
(_+_ : (Mâ‚€.Ï€â‚‚.Ï€â‚‚ (Mâ‚€.Ï€â‚‚.Ï€â‚, Mâ‚€.Ï€â‚‚.Ï€â‚)) â‰¡ Mâ‚€.Ï€â‚‚.Ï€â‚)
â†’ f Mâ‚€ â‰¡ Mâ‚€.Ï€â‚‚.Ï€â‚
â‰…
(Mâ‚€ : Monoid)
(_+_ : (Mâ‚€.Ï€â‚‚.Ï€â‚‚ (Mâ‚€.Ï€â‚‚.Ï€â‚, Mâ‚€.Ï€â‚‚.Ï€â‚)) â‰¡ Mâ‚€.Ï€â‚‚.Ï€â‚) //true by monoid identity law
â†’ f Mâ‚€ â‰¡ Mâ‚€.Ï€â‚‚.Ï€â‚
â‰…
(Mâ‚€ : Monoid) â†’ f Mâ‚€ â‰¡ Mâ‚€.Ï€â‚‚.Ï€â‚


T type
t : T
ext : âŸ¦TâŸ§(t)

ext : (A : ğ•Œ) (B : ğ•Œ) (R : Rel A B) (a : A) (b : B) (r : R a b) â†’ R (Î± A a) (Î± B b)

âŸ¦A â†’ BâŸ§(f, g) = (aâ‚€ : âŸ¦AâŸ§â‚€) (aâ‚ : âŸ¦AâŸ§â‚) (a : âŸ¦AâŸ§(aâ‚€, aâ‚)) â†’ âŸ¦BâŸ§(f aâ‚€, g aâ‚)

Intuition behind cubical TT:
(x : ğ•€) âŠ¦ M : A
There is a path x.A between
A(0/x) and A(1/x)
moreover via univalence we have an equivalence:
A(0/x) â‰ƒ A(1/x)
Then
M(0/x) corresponds M(1/x) across the isomorphism via x.M

Similarly, intuition behind parametric TT:
(x : ğˆ) âŠ¦ M : A
There is a relation x.A between A(0/x) and A(1/x)
and moreover
x.M is a proof that M(0/x) and M(1/x) stand in the relation

Î© âŠ¦ M : A
=> //weakening âœ”
Î© (x : ğˆ) âŠ¦ M(â†‘) : A(â†‘)

Î© (x : ğˆ) (y : ğˆ) âŠ¦ M : A
=> //exchange âœ”
Î© (y : ğˆ) (x : ğˆ) âŠ¦ M(âŸ·) : A(âŸ·)

Î© (x : ğˆ) (y : ğˆ) âŠ¦ M : A
=> //contraction âœ—
Î© (z : ğˆ) âŠ¦ M[z/x, z/y] : A[z/x, z/y]

But we have fresh substitution.
So basically it's like having structural substitution but restricting to only affine variable use.


(x : ğˆ) âŠ¦ A type
Mâ‚€ : A(0/x)
Mâ‚ : A(1/x)
---------------------
Bridge x.A Mâ‚€ Mâ‚ type

(x : ğˆ) âŠ¦ M : A
--------------------------------
x â†¦ M : Bridge x.A M(0/x) M(1/x)

P : Bridge x.A Mâ‚€ Mâ‚
r : ğˆ
r is fresh in P
--------------------
P r : A(r/x)


((X : ğ•Œ) â†’ X) â‰… ğŸ˜
âˆ
=>) f : (X : ğ•Œ) â†’ X

    f ğŸ˜ : ğŸ˜
<=) // easy
><) //easy
<>) //easy âˆ
//Proof doesn't require parametricity


(x : â„•) ctx âœ”
(x : â„•) âŠ¦ (x â‰¡ 1) type âœ”
(x : â„•) âŠ¦ x = 1 : â„• âœ—
---------------------------------------------
(x : â„•) âŠ¦ Sing (x â‰¡ 1) Refl type
