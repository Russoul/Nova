syntax e{â‰¥3} â¨¯ e{â‰¥2} : e{2}

syntax e{â‰¥3} â†’ e{â‰¥2} : e{2}

syntax e{â‰¥3} , e{â‰¥2} : e{2}

syntax e{â‰¥2} â‰¡ e{â‰¥2} âˆˆ e{â‰¥2} : e{1}

syntax e{â‰¥3} $ e{â‰¥3} : e{0}

let test0 : â„•
          â‰” Z

let test1 : â„• â¨¯ â„• â¨¯ â„•
          â‰” Z , S Z , S (S Z)

let test4 : (A : ğ•Œ) â¨¯ A
          â‰” â„• , Z

let test31 : Z â‰¡ ? âˆˆ â„•
           â‰” Refl

let the : (A : ğ•Œ) â†’ A â†’ A
        â‰” A x â†¦ x

let id : {A : ğ•Œ} â†’ A â†’ A
       â‰” {A} â†¦ x â†¦ x

let sym : {A : ğ•Œ} â†’ {aâ‚€ aâ‚ : A} â†’ (aâ‚€ â‰¡ aâ‚ âˆˆ A) â†’ (aâ‚ â‰¡ aâ‚€ âˆˆ A)
        â‰” {A aâ‚€ aâ‚} â†¦ a â†¦ J ? ? (x. e. x â‰¡ aâ‚€ âˆˆ A) Refl ? a

let fun-eta : (A : ğ•Œ) â†’ (B : A â†’ ğ•Œ) â†’ (f : (x : A) â†’ B x) â†’ ((x â†¦ f x) â‰¡ f âˆˆ ((x : A) â†’ B x))
            â‰” A B f â†¦ Î -Î· f

let fun-ext : {A : ğ•Œ} â†’ {B : A â†’ ğ•Œ} â†’ {f g : (x : A) â†’ B x} â†’ (p : (x : A) â†’ f x â‰¡ g x âˆˆ B x) â†’ f â‰¡ g âˆˆ ((x : A) â†’ B x)
            â‰” {A B f g} â†¦ p â†¦ J ? ? (Î±. h. Î± â‰¡ g âˆˆ ?) (J ? ? (Î±. h. ?(A , B , f , g , p) â‰¡ Î± âˆˆ ?) (Î â¼ (x. ?) (x. ?) (x. p x)) ? (Î -Î· ?)) ? (Î -Î· ?)

let happly' : (A : ğ•Œ) â†’ (B : ğ•Œ) â†’ (f : A â†’ B) â†’ (g : A â†’ B) â†’ (p : f â‰¡ g âˆˆ ?) â†’ (x : A) â†’ f x â‰¡ g x âˆˆ ?
            â‰” A B f g p â†¦ x â†¦ J ? ? (Î±.h. f x â‰¡ Î± x âˆˆ ?) Refl ? p

let happly : (A : ğ•Œ) â†’ (B : A â†’ ğ•Œ) â†’ (f : (x : A) â†’ B x) â†’ (g : (x : A) â†’ B x) â†’ (p : f â‰¡ g âˆˆ ?) â†’ (x : A) â†’ f x â‰¡ g x âˆˆ ?
           â‰” A B f g p x â†¦ J ? ? (Î±.h. f x â‰¡ Î± x âˆˆ ?) Refl ? p

let cong : (A : ğ•Œ) â†’ (B : ğ•Œ) â†’ (f : A â†’ B) â†’ (aâ‚€ : A) â†’ (aâ‚ : A) â†’ (a : aâ‚€ â‰¡ aâ‚ âˆˆ ?) â†’ f aâ‚€ â‰¡ f aâ‚ âˆˆ ?
         â‰” A B f aâ‚€ aâ‚ a â†¦ J ? ? (x. h. f aâ‚€ â‰¡ f x âˆˆ ?) Refl ? a

let transp : (A : ğ•Œ) â†’ (B : A â†’ ğ•Œ) â†’ {aâ‚€ aâ‚ : A} â†’ (a : aâ‚€ â‰¡ aâ‚ âˆˆ ?) â†’ B aâ‚€ â†’ B aâ‚
           â‰” A B â†¦ {aâ‚€ aâ‚} â†¦ a â†¦ t â†¦ J ? ? (Î±. h. B Î±) t ? a

let S-cong : {x y : â„•} â†’ (e : x â‰¡ y âˆˆ ?) â†’ S x â‰¡ S y âˆˆ ?
           â‰” {x y} â†¦ e â†¦ J ? ? (z. h. S x â‰¡ S z âˆˆ ?) Refl ? e

syntax e{â‰¥4} + e{â‰¥5} : e{4}

syntax e{â‰¥4} @ e{â‰¥5} : e{4}

syntax e{â‰¥6} * e{â‰¥7} : e{6}

-- 0   + y = y
-- S x + y = S (x + y)
let _+_ : â„• â†’ â„• â†’ â„•
        â‰” x y â†¦ â„•-elim (z. â„•) y (x. h. S h) x

let plus-left-Z : (x : â„•) â†’ Z + x â‰¡ x âˆˆ â„•
                â‰” x â†¦ J ? ?
                        (Î±. h. Î± Z x â‰¡ x âˆˆ â„•)
                        (J ? ?
                           (Î±. h. Î± x â‰¡ x âˆˆ â„•)
                           (J ? ?
                              (Î±. h. Î± â‰¡ x âˆˆ â„•)
                              (J ? ? (Î±. h. Î± â‰¡ x âˆˆ â„•) Refl ? (sym (â„•-Î²-Z (x. â„•) ? (x.h. S h))))
                              ?
                              (sym (Î -Î² ? (x. ?) (y. â„•-elim (x. â„•) y (x. h. S h) Z) ?))
                           )
                           ?
                           (sym {? â†’ ?} (Î -Î² ? (x. ?) (x. y â†¦ â„•-elim (z. â„•) y (x. h. S h) x) Z))
                        )
                        ?
                        (sym !_+_)

let plus-left-S : (t : â„•) â†’ (x : â„•) â†’ (S t + x) â‰¡ S (t + x) âˆˆ â„•
                â‰” t â†¦ x â†¦ J ? ?
                            (_@_. h. S t @ x â‰¡ S (t + x) âˆˆ â„•)
                            (J ? ?
                               (Î±. h. Î± x â‰¡ S (t + x) âˆˆ â„•)
                               (J ? ?
                                  (Î±. h. Î± â‰¡ S (t + x) âˆˆ â„•)
                                  (J ? ?
                                     (Î±. h. Î± â‰¡ S (t + x) âˆˆ â„•)
                                     (S-cong (J ? ?
                                                (Î±. h. Î± â‰¡ t + x âˆˆ â„•)
                                                (J ? ?
                                                   (Î±. h. Î± x â‰¡ t + x âˆˆ â„•)
                                                   (J ? ? (Î±. h. Î± t x â‰¡ t + x âˆˆ â„•) Refl ? !_+_)
                                                   ?
                                                   (Î -Î² â„• (x. â„• â†’ â„•) (x. y â†¦ â„•-elim (z. â„•) y (x.h. S h) x) t)
                                                )
                                                ?
                                                (Î -Î² ? (x. ?) (y. â„•-elim (z. â„•) y (x.h. S h) t) x)
                                             ))
                                     ?
                                     (sym (â„•-Î²-S (z. â„•) x (x.h. S h) t))
                                  )
                                  ?
                                  (sym (Î -Î² ? (x. ?) (y.  â„•-elim (z. â„•) y (x.h. S h) (S t)) x))
                               )
                               ?
                               (sym (Î -Î² ? (x. ?) (x. y â†¦ â„•-elim (z. â„•) y (x.h. S h) x) (S t)))
                            )
                            ?
                            (sym !_+_)

let plus-right-Z : (x : â„•) â†’ x + Z â‰¡ x âˆˆ â„•
                 â‰” x â†¦ â„•-elim (x. x + Z â‰¡ x âˆˆ â„•)
                              (J ? ? (Î±. h. Î± â‰¡ Z âˆˆ â„•) Refl ? (sym (plus-left-Z Z)))
                              (x. h. J ? ? (Î±. h. Î± â‰¡ S x âˆˆ â„•) (S-cong h) ? (sym (plus-left-S x Z)))
                              x

-- (x y : â„•) (h : x + S y â‰¡ S (x + y) âˆˆ â„•) âŠ¦ S x + S y â‰¡ S (S x + y)
--                                           S (x + S y) â‰¡ S (S x + y)
--                                           x + S y â‰¡ S x + y
--                                           x + S y â‰¡ S (x + y)
let plus-right-S : (x y : â„•) â†’ (x + S y) â‰¡ S (x + y) âˆˆ â„•
                 â‰” x y â†¦ â„•-elim (x. (x + S y) â‰¡ S (x + y) âˆˆ â„•)
                                (tac rewriteâ»Â¹ (â˜ â‰¡ _ âˆˆ _) (plus-left-Z (S y));
                                     exact (S-cong (tac rewriteâ»Â¹ (_ â‰¡ â˜ âˆˆ _) (plus-left-Z y); trivial;));
                                )
                                (x. h. tac rewriteâ»Â¹ (â˜ â‰¡ _ âˆˆ _) (plus-left-S ? ?);
                                           exact S-cong (tac rewriteâ»Â¹ (_ â‰¡ â˜ âˆˆ _) (plus-left-S ? ?); exact h;);
                                )
                                x


let plus-commut : (x y : â„•) â†’ x + y â‰¡ y + x âˆˆ â„•
                â‰” x y â†¦
                   â„•-elim (x. (y : â„•) â†’ x + y â‰¡ y + x âˆˆ â„•)
                          (y â†¦ tac
                             rewriteâ»Â¹ (â˜ â‰¡ _ âˆˆ _) (plus-left-Z ?);
                             rewriteâ»Â¹ (_ â‰¡ â˜ âˆˆ _) (plus-right-Z ?);
                             trivial;
                          )
                          (x. h. y â†¦ tac
                            rewriteâ»Â¹ (â˜ â‰¡ _ âˆˆ _) (plus-left-S ? ?);
                            rewriteâ»Â¹ (_ â‰¡ â˜ âˆˆ _) (plus-right-S ? ?);
                            exact (S-cong (h ?));
                          )
                          x y

-- 0 * y = 0
-- (1 + x) * y = y + x * y
let _*_ : â„• â†’ â„• â†’ â„•
        â‰” x y â†¦ â„•-elim (x. â„•) Z (x. h. y + h) x


let mult-left-Z : (x : â„•) â†’ Z * x â‰¡ Z âˆˆ ?
                â‰” x â†¦ tac
                    reduce â˜ _ _ â‰¡ _ âˆˆ _;
                    reduce â˜ _ â‰¡ _ âˆˆ _;
                    reduce â˜ â‰¡ _ âˆˆ _;
                    reduce â˜ â‰¡ _ âˆˆ _;
                    trivial;


let mult-left-S : (t : â„•) â†’ (x : â„•) â†’ (S t * x) â‰¡ (x + t * x) âˆˆ ?
                â‰” t x â†¦ tac
                    reduce â˜ _ _ â‰¡ _ âˆˆ _;
                    reduce â˜ _ â‰¡ _ âˆˆ _;
                    reduce â˜ â‰¡ _ âˆˆ _;
                    reduce â˜ â‰¡ _ âˆˆ _;
                    reduce _ â‰¡ _ + â˜ _ _ âˆˆ _;
                    reduce _ â‰¡ _ + â˜ _ âˆˆ _;
                    reduce _ â‰¡ _ + â˜ âˆˆ _;
                    trivial;

let Nat-eta : (A : â„• â†’ ğ•Œ)
            â†’ (f : (x : â„•) â†’ A x)
            â†’ (z : A Z)
            â†’ (s : (x : â„•) â†’ A x â†’ A (S x))
            â†’ (f Z â‰¡ z âˆˆ ?)
            â†’ ((x : â„•) â†’ f (S x) â‰¡ s x (f x) âˆˆ ?)
            â†’ (f â‰¡ (x â†¦ â„•-elim (x. A x) z (x. h. s x h) x) âˆˆ ?)
            â‰” A f z s c0 c1 â†¦ fun-ext (x â†¦ tac reduce _ â‰¡ â˜ âˆˆ _;
                                               exact â„•-elim
                                                       (x. f x â‰¡ â„•-elim (x. A x) z (x.h. s x h) x âˆˆ A x)
                                                       (tac reduce _ â‰¡ â˜ âˆˆ _; exact c0;)
                                                       (x. h. tac reduce _ â‰¡ â˜ âˆˆ _; rewrite (_ â‰¡ _ â˜ âˆˆ _) h; exact c1 x;)
                                                       x;
                                      )

syntax e{â‰¥6} âˆ˜ e{â‰¥5} : e{5}

syntax e{â‰¥10} â‰… e{â‰¥10} : e{9}

let _âˆ˜_ : {A : ğ•Œ} â†’ {B : ğ•Œ} â†’ {C : ğ•Œ} â†’ (g : B â†’ C) â†’ (f : A â†’ B) â†’ A â†’ C
        â‰” {A B C} â†¦ g f x â†¦ g (f x)

let _â‰…_ : ğ•Œ â†’ ğ•Œ â†’ ğ•Œ
        â‰” A B â†¦ (f : A â†’ B) â¨¯ (g : B â†’ A) â¨¯ (g âˆ˜ f â‰¡ id âˆˆ ?) â¨¯ (f âˆ˜ g â‰¡ id âˆˆ ?)
