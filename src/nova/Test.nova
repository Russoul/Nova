let test0 : â„•
          â‰” Z

let test1 : â„• â¨¯ â„• â¨¯ â„•
          â‰” Z , S Z , S (S Z)

let test4 : (A : ğ•Œ) â¨¯ A
          â‰” â„• , Z

let test31 : Z â‰¡ ? âˆˆ â„•
           â‰” Refl

define sym : {A : ğ•Œ} â†’ {aâ‚€ aâ‚ : A} â†’ (aâ‚€ â‰¡ aâ‚ âˆˆ A) â†’ (aâ‚ â‰¡ aâ‚€ âˆˆ A)
           â‰” {A aâ‚€ aâ‚} â†¦ a â†¦ J ? ? (x. e. x â‰¡ aâ‚€ âˆˆ A) Refl ? a

define fun-eta : (A : ğ•Œ) â†’ (B : A â†’ ğ•Œ) â†’ (f : (x : A) â†’ B x) â†’ ((x â†¦ f x) â‰¡ f âˆˆ ((x : A) â†’ B x))
               â‰” A B f â†¦ Î -Î· f

define fun-ext : {A : ğ•Œ} â†’ {B : A â†’ ğ•Œ} â†’ {f g : (x : A) â†’ B x} â†’ (p : (x : A) â†’ f x â‰¡ g x âˆˆ B x) â†’ f â‰¡ g âˆˆ ((x : A) â†’ B x)
               â‰” {A B f g} â†¦ p â†¦ J ? ? (Î±. h. Î± â‰¡ g âˆˆ ?) (J ? ? (Î±. h. ?(A , B , f , g , p) â‰¡ Î± âˆˆ ?) (Î â¼ (x. ?) (x. ?) (x. p x)) ? (Î -Î· ?)) ? (Î -Î· ?)

define happly' : (A : ğ•Œ) â†’ (B : ğ•Œ) â†’ (f : A â†’ B) â†’ (g : A â†’ B) â†’ (p : f â‰¡ g âˆˆ ?) â†’ (x : A) â†’ f x â‰¡ g x âˆˆ ?
               â‰” A B f g p â†¦ x â†¦ J ? ? (Î±.h. f x â‰¡ Î± x âˆˆ ?) Refl ? p

define happly : (A : ğ•Œ) â†’ (B : A â†’ ğ•Œ) â†’ (f : (x : A) â†’ B x) â†’ (g : (x : A) â†’ B x) â†’ (p : f â‰¡ g âˆˆ ?) â†’ (x : A) â†’ f x â‰¡ g x âˆˆ ?
              â‰” A B f g p x â†¦ J ? ? (Î±.h. f x â‰¡ Î± x âˆˆ ?) Refl ? p

define cong : {A B : ğ•Œ} â†’ (f : A â†’ B) â†’ {aâ‚€ aâ‚ : A} â†’ (a : aâ‚€ â‰¡ aâ‚ âˆˆ ?) â†’ f aâ‚€ â‰¡ f aâ‚ âˆˆ ?
            â‰” {A B} â†¦ f â†¦ {aâ‚€ aâ‚} â†¦ a â†¦ J ? ? (x. h. f aâ‚€ â‰¡ f x âˆˆ ?) Refl ? a

define transp : (A : ğ•Œ) â†’ (B : A â†’ ğ•Œ) â†’ {aâ‚€ aâ‚ : A} â†’ (a : aâ‚€ â‰¡ aâ‚ âˆˆ ?) â†’ B aâ‚€ â†’ B aâ‚
              â‰” A B â†¦ {aâ‚€ aâ‚} â†¦ a â†¦ t â†¦ J ? ? (Î±. h. B Î±) t ? a


let pred' : â„• â†’ â„•
          â‰” x â†¦ â„•-elim (x. â„•) Z (x.h. x) x

define pred'-S : (x : â„•) â†’ pred' (S x) â‰¡ x âˆˆ â„•
               â‰” x â†¦ tac
                   unfold â˜ â‰¡ _ âˆˆ _;
                   trivial;

define S-cong-inv-H0 : {x y : â„•} â†’ (e : pred' (S x) â‰¡ pred' (S y) âˆˆ ?) â†’ x â‰¡ y âˆˆ ?
                     â‰” {x y} â†¦ tac
                          rewriteâ»Â¹ ((x : â˜ â‰¡ _ âˆˆ _) â†’ _) (pred'-S ?);
                          rewriteâ»Â¹ ((x : _ â‰¡ â˜ âˆˆ _) â†’ _) (pred'-S ?);
                          exact id;

define S-cong-inv : {x y : â„•} â†’ (e : S x â‰¡ S y âˆˆ ?) â†’ x â‰¡ y âˆˆ ?
                  â‰” {x y} â†¦ e â†¦ S-cong-inv-H0 (cong pred' e)

let Vect : â„• â†’ ğ•Œ â†’ ğ•Œ
         â‰” n A â†¦ â„•-elim (x. ğ•Œ) ğŸ™ (x.H. A â¨¯ H) n

let nil : {A : ğ•Œ} â†’ Vect Z A
        â‰” {A} â†¦ tac unfold â˜;
                    exact tt;

let Vect-Z : {A : ğ•Œ} â†’ Vect Z A â‰¡ ğŸ™ âˆˆ ğ•Œ
               â‰” {A} â†¦ tac
                     unfold â˜ â‰¡ _ âˆˆ _;
                     trivial;

let Vect-S : {A : ğ•Œ} â†’ {n : â„•} â†’ Vect (S n) A â‰¡ A â¨¯ Vect n A âˆˆ ğ•Œ
               â‰” {A n} â†¦ tac
                     unfold â˜ â‰¡ _ âˆˆ _;
                     unfold _ â‰¡ ((x : _) â¨¯ â˜ _ _) âˆˆ _;
                     trivial;

define nil-unique : {A : ğ•Œ} â†’ (xs : Vect Z A) â†’ xs â‰¡ nil {A} âˆˆ Vect Z A
                  â‰”
                   {A} â†¦ tac
                      rewriteâ»Â¹ ((x : â˜) â†’ _) Vect-Z;
                      rewriteâ»Â¹ ((x : _) â†’ _ â‰¡ _ âˆˆ â˜) Vect-Z;
                      exact (xs â†¦ ğŸ™â¼ ? ?);


let _::_ : {A : ğ•Œ} â†’ {n : â„•} â†’ A â†’ Vect n A â†’ Vect (S n) A
         â‰” {A n} â†¦ x xs â†¦ tac
             rewriteâ»Â¹ â˜ Vect-S;
             exact x , xs;

define prod-Î· : {A B : ğ•Œ} â†’ (p : A â¨¯ B) â†’ (p .Ï€â‚ , p .Ï€â‚‚) â‰¡ p âˆˆ ?
              â‰” {A B} â†¦ p â†¦ Î£-Î· p


define Vect-elim-H : {A : ğ•Œ}
                   â†’ (P : (n : â„•) â†’ Vect n A â†’ ğ•Œ)
                   â†’ (n : â„•)
                   â†’ (xs : A â¨¯ Vect n A)
                   â†’ P (S n) (xs .Ï€â‚ :: xs .Ï€â‚‚)
                   â†’ P (S n) (tac rewriteâ»Â¹ â˜ Vect-S; exact (xs .Ï€â‚ , xs .Ï€â‚‚);)
                   â‰” {A} â†¦ P n xs â†¦ tac
                       unfold P _ â˜ â†’ _;
                       exact id;

let Vect-elim : {A : ğ•Œ}
              â†’ {n : â„•}
              â†’ (P : (n : â„•) â†’ Vect n A â†’ ğ•Œ)
              â†’ (nil : P Z nil)
              â†’ (cons : (n : â„•) â†’ (x : A) â†’ (xs : Vect n A) â†’ P n xs â†’ P (S n) (x :: xs))
              â†’ (xs : Vect n A)
              â†’ P n xs
              â‰” {A n} â†¦ P nil cons xs â†¦ â„•-elim (n. (xs : Vect n A) â†’ P n xs)
                  (tac
                       rewriteâ»Â¹ (_ â†’ _ â˜) (nil-unique xs);
                       exact (xs â†¦ nil);
                  )
                  -- (n : â„•) (h : (xs : Vect n A) â†’ P n xs) âŠ¦ s : (xs : A â¨¯ Vect n A) â†’ P (S n) (xs.Ï€â‚, xs.Ï€â‚‚)
                  -- xs.Ï€â‚ : A
                  -- xs.Ï€â‚‚ : Vect n A
                  -- h xs.Ï€â‚‚ : P n xs.Ï€â‚‚
                  -- cons n xs.Ï€â‚ xs.Ï€â‚‚ (h xs.Ï€â‚‚) : P (S n) (cons xs.Ï€â‚ xs.Ï€â‚‚)
                  (n. h. tac
                    rewriteâ»Â¹ (â˜ â†’ _) Vect-S;
                    rewrite (_ â†’ _ â˜) (Î£-Î· xs);
                    exact (xs â†¦ Vect-elim-H P n xs (cons n (xs .Ï€â‚) (xs .Ï€â‚‚) (h (xs .Ï€â‚‚))));
                  )
                  n xs

define Vect-elim-nil : {A : ğ•Œ}
                     â†’ (P : (n : â„•) â†’ Vect n A â†’ ğ•Œ)
                     â†’ (onNil : P Z nil)
                     â†’ (onCons : (n : â„•) â†’ (x : A) â†’ (xs : Vect n A) â†’ P n xs â†’ P (S n) (x :: xs))
                     â†’ Vect-elim P onNil onCons nil â‰¡ onNil âˆˆ ?
                     â‰” {A} â†¦ P onNil onCons â†¦ tac
                          unfold â˜ â‰¡ _ âˆˆ _;
                          trivial;

define Vect-elim-cons : {A : ğ•Œ}
                      â†’ {n : â„•}
                      â†’ (P : (n : â„•) â†’ Vect n A â†’ ğ•Œ)
                      â†’ (onNil : P Z nil)
                      â†’ (onCons : (n : â„•) â†’ (x : A) â†’ (xs : Vect n A) â†’ P n xs â†’ P (S n) (x :: xs))
                      â†’ (x : A)
                      â†’ (xs : Vect n A)
                      â†’ Vect-elim P onNil onCons (x :: xs) â‰¡ onCons n x xs (Vect-elim P onNil onCons xs) âˆˆ ?
                      â‰” {A n} â†¦ P onNil onCons x xs â†¦ tac
                          unfold â˜ â‰¡ _ âˆˆ _;
                          unfold â˜ â‰¡ _ âˆˆ _;
                          unfold onCons _ _ â˜ _ â‰¡ _ âˆˆ _;
                          unfold onCons _ â˜ _ _ â‰¡ _ âˆˆ _;
                          unfold onCons _ _ _ (â„•-elim _ _ (xs â†¦ â˜) n _) â‰¡ _ âˆˆ _;
                          unfold onCons _ _ _ (â„•-elim _ _ _ _ â˜) â‰¡ _ âˆˆ _;
                          unfold _ â‰¡ onCons _ _ _ â˜ âˆˆ _;
                          unfold _ â‰¡ onCons _ _ _ (â„•-elim _ _ (xs â†¦ â˜) n _) âˆˆ _;
                          trivial;


-- 0   + y = y
-- S x + y = S (x + y)
let _+_ : â„• â†’ â„• â†’ â„•
        â‰” x y â†¦ â„•-elim (z. â„•) y (x. h. S h) x

define plus-left-Z : (x : â„•) â†’ Z + x â‰¡ x âˆˆ â„•
                   â‰” x â†¦ J ? ?
                           (Î±. h. Î± Z x â‰¡ x âˆˆ â„•)
                           Refl
                           ?
                           (sym !_+_)

define plus-left-S : (t : â„•) â†’ (x : â„•) â†’ (S t + x) â‰¡ S (t + x) âˆˆ â„•
                   â‰” t â†¦ x â†¦ J ? ?
                               (_@_. h. S t @ x â‰¡ S (t @ x) âˆˆ â„•)
                               (cong (the (â„• â†’ â„•) (x â†¦ S x))
                               Refl
                               )
                               ?
                               (sym !_+_)


define plus-right-Z : (x : â„•) â†’ x + Z â‰¡ x âˆˆ â„•
                    â‰” x â†¦ â„•-elim (x. x + Z â‰¡ x âˆˆ â„•)
                                 (J ? ? (Î±. h. Î± â‰¡ Z âˆˆ â„•) Refl ? (sym (plus-left-Z Z)))
                                 (x. h. J ? ? (Î±. h. Î± â‰¡ S x âˆˆ â„•) (cong (x â†¦ S x) h) ? (sym (plus-left-S x Z)))
                                 x


-- (x y : â„•) (h : x + S y â‰¡ S (x + y) âˆˆ â„•) âŠ¦ S x + S y â‰¡ S (S x + y)
--                                           S (x + S y) â‰¡ S (S x + y)
--                                           x + S y â‰¡ S x + y
--                                           x + S y â‰¡ S (x + y)
define plus-right-S : (x y : â„•) â†’ (x + S y) â‰¡ S (x + y) âˆˆ â„•
                    â‰” x y â†¦ â„•-elim (x. (x + S y) â‰¡ S (x + y) âˆˆ â„•)
                                   (tac rewriteâ»Â¹ (â˜ â‰¡ _ âˆˆ _) (plus-left-Z (S y));
                                        exact (cong (the (â„• â†’ â„•) (x â†¦ S x)) (tac rewriteâ»Â¹ (_ â‰¡ â˜ âˆˆ _) (plus-left-Z y); trivial;));
                                   )
                                   (x. h. tac rewriteâ»Â¹ (â˜ â‰¡ _ âˆˆ _) (plus-left-S ? ?);
                                              exact cong (the (â„• â†’ â„•) (x â†¦ S x)) (tac rewriteâ»Â¹ (_ â‰¡ â˜ âˆˆ _) (plus-left-S ? ?); exact h;);
                                   )
                                   x


define plus-commut : (x y : â„•) â†’ x + y â‰¡ y + x âˆˆ â„•
                   â‰” x y â†¦
                      â„•-elim (x. (y : â„•) â†’ x + y â‰¡ y + x âˆˆ â„•)
                             (y â†¦ tac
                                rewriteâ»Â¹ (â˜ â‰¡ _ âˆˆ _) (plus-left-Z ?);
                                rewriteâ»Â¹ (_ â‰¡ â˜ âˆˆ _) (plus-right-Z ?);
                                trivial;
                             )
                             (x. h. y â†¦ tac
                               rewriteâ»Â¹ (â˜ â‰¡ _ âˆˆ _) (plus-left-S ? ?);
                               rewriteâ»Â¹ (_ â‰¡ â˜ âˆˆ _) (plus-right-S ? ?);
                               exact (cong (x â†¦ S x) (h ?));
                             )
                             x y

-- 0 * y = 0
-- (1 + x) * y = y + x * y
let _*_ : â„• â†’ â„• â†’ â„•
        â‰” x y â†¦ â„•-elim (x. â„•) Z (x. h. y + h) x


define mult-left-Z : (x : â„•) â†’ Z * x â‰¡ Z âˆˆ ?
                    â‰” x â†¦ tac
                        unfold â˜ â‰¡ _ âˆˆ _;
                        trivial;

define mult-right-Z : (x : â„•) â†’ x * Z â‰¡ Z âˆˆ ?
                    â‰” x â†¦ tac
                        unfold â˜ â‰¡ _ âˆˆ _;
                        rewriteâ»Â¹ (â„•-elim _ _ â˜ _ â‰¡ _ âˆˆ _) (plus-left-Z ?);
                        exact â„•-elim (x. â„•-elim (x. â„•) Z (x.h. h) x â‰¡ Z âˆˆ â„•) (tac trivial;) (x. h. tac exact h;) x;


define mult-left-S : (t : â„•) â†’ (x : â„•) â†’ (S t * x) â‰¡ (x + t * x) âˆˆ ?
                   â‰” t x â†¦ tac
                       unfold â˜ â‰¡ _ âˆˆ _;
                       unfold _ â‰¡ _ + â˜ âˆˆ _;
                       trivial;


define Nat-eta : (A : â„• â†’ ğ•Œ)
               â†’ (f : (x : â„•) â†’ A x)
               â†’ (z : A Z)
               â†’ (s : (x : â„•) â†’ A x â†’ A (S x))
               â†’ (f Z â‰¡ z âˆˆ ?)
               â†’ ((x : â„•) â†’ f (S x) â‰¡ s x (f x) âˆˆ ?)
               â†’ (f â‰¡ (x â†¦ â„•-elim (x. A x) z (x. h. s x h) x) âˆˆ ?)
               â‰” A f z s c0 c1 â†¦ fun-ext (x â†¦ â„•-elim (x. f x â‰¡ â„•-elim (x. A x) z (x.h. s x h) x âˆˆ A x) c0 (x.h. tac rewrite (_ â‰¡ _ â˜ âˆˆ _) h; exact c1 x;) x)


define trans : {A : ğ•Œ}
             â†’ {x y z : A}
             â†’ (x â‰¡ y âˆˆ A)
             â†’ (y â‰¡ z âˆˆ A)
             â†’ (x â‰¡ z âˆˆ A)
             â‰” {A x y z} â†¦ p q â†¦
                 tac rewrite (_ â‰¡ â˜ âˆˆ _) q;
                     rewrite (_ â‰¡ â˜ âˆˆ _) p;
                     trivial;


-- x + y â‰¡ x + z â†’ y â‰¡ z
define â„•-left-cancel : (x y z : â„•) â†’ (x + y â‰¡ x + z âˆˆ â„•) â†’ (y â‰¡ z âˆˆ â„•)
                     â‰” x y z p â†¦ â„•-elim (x. (x + y â‰¡ x + z âˆˆ â„•) â†’ (y â‰¡ z âˆˆ â„•))
                     -- (x : â„•) (y : â„•) (z : â„•) (p : _+_(Â·) x y â‰¡ _+_(Â·) x z âˆˆ â„•)  âŠ¦ z : (_+_(Â·) 0 y â‰¡ _+_(Â·) 0 z âˆˆ â„•) â†’ (y â‰¡ z âˆˆ â„•) (NoSolve)
                       (tac rewriteâ»Â¹ ((x : â˜ â‰¡ _ âˆˆ _) â†’ _) (plus-left-Z ?);
                            rewriteâ»Â¹ ((x : _ â‰¡ â˜ âˆˆ _) â†’ _) (plus-left-Z ?);
                            exact id;)
                     -- (x : â„•) (y : â„•) (z : â„•) (p : _+_(Â·) x y â‰¡ _+_(Â·) x z âˆˆ â„•) (x : â„•) (h : (x + y â‰¡ x + z âˆˆ â„•) â†’ (y â‰¡ z âˆˆ â„•))  âŠ¦
                     -- s : (S (x + y) â‰¡ S (x + z) âˆˆ â„•) â†’ (y â‰¡ z âˆˆ â„•) (NoSolve)
                       (x.h. tac rewriteâ»Â¹ ((x : â˜ â‰¡ _ âˆˆ _) â†’ _) (plus-left-S ? ?);
                                 rewriteâ»Â¹ ((x : _ â‰¡ â˜ âˆˆ _) â†’ _) (plus-left-S ? ?);
                                 exact (t â†¦ h (S-cong-inv t));
                       )
                       x p

define plus-assoc : (x y z : â„•) â†’ x + (y + z) â‰¡ (x + y) + z âˆˆ â„•
                  â‰” x y z â†¦ â„•-elim (y. x + (y + z) â‰¡ (x + y) + z âˆˆ â„•)
                      -- x + z = x + z
                      (tac rewriteâ»Â¹ (_ â˜ â‰¡ _ âˆˆ _) (plus-left-Z ?);
                           rewriteâ»Â¹ (_ â‰¡ _ â˜ _ âˆˆ _) (plus-right-Z ?);
                           exact Refl;
                      )
                      (y. H.
                        tac rewriteâ»Â¹ (_ â˜ â‰¡ _ âˆˆ _) (plus-left-S ? ?);
                            rewriteâ»Â¹ (â˜ â‰¡ _ âˆˆ _) (plus-right-S ? ?);
                            rewriteâ»Â¹ (_ â‰¡ _ â˜ _ âˆˆ _) (plus-right-S ? ?);
                            rewriteâ»Â¹ (_ â‰¡ â˜ âˆˆ _) (plus-left-S ? ?);
                            exact cong (x â†¦ S x) H;
                      )
                      y

-- x + y + z + y + z + y + x = x + x + y + y + y + z + z
-- Proof using a commutative-monad solver tactic
-- define test-nat-solver-0 : (x y z : â„•) â†’ x + y + z + y + z + y + x â‰¡ x + x + y + y + y + z + z âˆˆ â„•
--                          â‰” x y z â†¦ tac normalise-nat â˜ â‰¡ _ âˆˆ _; trivial;

-- [] ++ ys = ys
-- (x :: xs) ++ ys = x :: (xs ++ ys)

let _++_ : {A : ğ•Œ} â†’ {m n : â„•} â†’ Vect m A â†’ Vect n A â†’ Vect (m + n) A
         â‰” {A m n} â†¦ xs ys â†¦ Vect-elim (m xs â†¦ Vect (m + n) A)
            (tac rewriteâ»Â¹ (_ â˜ _) (plus-left-Z n); exact ys;)
            (m x xs h â†¦ tac rewriteâ»Â¹ (_ â˜ _) (plus-left-S ? ?); rewriteâ»Â¹ â˜ Vect-S; exact x, h;)
            xs

define append-left-nil : {A : ğ•Œ} â†’ {n : â„•} â†’ (xs : Vect n A) â†’ nil ++ xs â‰¡ (tac rewriteâ»Â¹ (_ â˜ _) (plus-left-Z ?); exact xs;) âˆˆ ?
                       â‰” {A n} â†¦ xs â†¦
                            tac unfold â˜ â‰¡ _ âˆˆ _;
                                unfold â˜ â‰¡ _ âˆˆ _;
                                trivial;

define append-left-cons : {A : ğ•Œ} â†’ {m n : â„•} â†’ (x : A) â†’ (xs : Vect m A) â†’ (ys : Vect n A) â†’ ((x :: xs) ++ ys â‰¡ (tac rewriteâ»Â¹ (_ â˜ _) (plus-left-S ? ?); exact x :: (xs ++ ys);) âˆˆ ?)
                        â‰” {A m n} â†¦ x xs ys â†¦ tac
                            unfold â˜ â‰¡ _ âˆˆ _;
                            unfold â˜ â‰¡ _ âˆˆ _;
                            unfold â˜ â‰¡ _ âˆˆ _;
                            unfold _ â‰¡ â˜ âˆˆ _;
                            unfold â˜ , _ â‰¡ _ âˆˆ _;
                            unfold _ â‰¡ _ , â˜  âˆˆ _;
                            unfold _ â‰¡ _ , â˜ âˆˆ _;
                            unfold _ , â„•-elim _ _ _ m â˜ â‰¡ _ âˆˆ _;
                            trivial;

-- xs ++ [] = xs

define append-right-nil : {A : ğ•Œ} â†’ {n : â„•} â†’ (xs : Vect n A) â†’ xs ++ nil â‰¡ (tac rewriteâ»Â¹ (_ â˜ _) (plus-right-Z ?); exact xs;) âˆˆ ?
                       â‰” {A n} â†¦ xs â†¦ Vect-elim (n xs â†¦ xs ++ nil â‰¡ (tac rewriteâ»Â¹ (_ â˜ _) (plus-right-Z ?); exact xs;) âˆˆ ?)
                           (tac rewriteâ»Â¹ (â˜ â‰¡ _ âˆˆ _) (append-left-nil nil); trivial;)
                           (n x xs h â†¦ tac rewriteâ»Â¹ (â˜ â‰¡ _ âˆˆ _) (append-left-cons ? ? ?); rewriteâ»Â¹ (_ â˜ â‰¡ _ âˆˆ _) h; rewriteâ»Â¹ (_ â˜ _ _ â‰¡ _ âˆˆ _) (plus-right-Z ?); trivial;)
                           xs

-- reverseH xs nil = xs
-- reverseH xs (y :: ys) = reverseH (y :: xs) ys

let reverseH : {A : ğ•Œ} â†’ {m n : â„•} â†’ Vect m A â†’ Vect n A â†’ Vect (m + n) A
                â‰”  {A m n} â†¦ xs ys â†¦ Vect-elim
                     (n ys â†¦ (m : â„•) â†’ Vect m A â†’ Vect (m + n) A)
                     (m xs â†¦ tac rewriteâ»Â¹ (_ â˜ _) (plus-right-Z ?); exact xs;)
                     -- h (S m) (y :: xs) : Vect (S m + n)
                     (n y ys h m xs â†¦ tac rewriteâ»Â¹ (_ â˜ _) (plus-right-S ? ?); rewrite (_ â˜ _) (plus-left-S ? ?); exact h ? (y :: xs);)
                     ys m xs


-- reverseH xs [] = xs

define reverseH-nil : {A : ğ•Œ} â†’ {n : â„•} â†’ (xs : Vect n A) â†’ reverseH xs nil â‰¡ (tac rewriteâ»Â¹ (_ â˜ _) (plus-right-Z ?); exact xs;) âˆˆ ?
                   â‰” {A n} â†¦ xs â†¦ tac unfold â˜ â‰¡ _ âˆˆ _; rewriteâ»Â¹ (â˜ _ _ â‰¡ _ âˆˆ _) (Vect-elim-nil (n â†¦ ys â†¦ (m : â„•) â†’ Vect m A â†’ Vect (m + n) A) ? ?); trivial;

-- reverseH xs (y :: ys) = reverse (y :: xs) ys

-- reverseH xs (y :: ys) : Vect (m + S n) A
-- reverseH (y :: xs) ys : Vect (S m + n) A

define reverseH-cons : {A : ğ•Œ} â†’ {m n : â„•} â†’ (xs : Vect m A) â†’ (y : A) â†’ (ys : Vect n A) â†’
                         (tac rewrite (_ â˜ _) (plus-right-S ? ?); exact reverseH xs (y :: ys);)
                            â‰¡
                         (tac rewrite (_ â˜ _) (plus-left-S ? ?); exact reverseH (y :: xs) ys;)
                            âˆˆ
                         Vect (S (m + n)) A

-- reverseH xs (y :: ys) = reverseH (y :: xs) ys

                     â‰” {A m n} â†¦ xs y ys â†¦ tac
                       unfold â˜ â‰¡ _ âˆˆ _;
                       unfold â˜ â‰¡ _ âˆˆ _;
                       unfold â˜ â‰¡ _ âˆˆ _;
                       unfold â„•-elim _ _ (x â†¦ â˜) _ _ _ _ â‰¡ _ âˆˆ _;
                       unfold â„•-elim _ _ _ _ â˜ _ _ â‰¡ _ âˆˆ _;
                       unfold â„•-elim _ _ _ _ _ _ (â˜ :: _) â‰¡ _ âˆˆ _;
                       unfold _ â‰¡ â˜ âˆˆ _;
                       unfold _ â‰¡ â˜ âˆˆ _;
                       unfold _ â‰¡ â„•-elim _ _ (x â†¦ â˜) _ _ _ _ âˆˆ _;
                       trivial;


-- (_::_(Â·) {A} {n} y ys .Ï€â‚‚)

-- reverse : Vect m â†’ Vect n A â†’ Vect (m + n)
-- reverse xs [] = xs : Vect (m + 0) A
-- reverse xs (y :: ys) = reverse (y :: xs) ys : Vect (m + S n) A

let reverse : {A : ğ•Œ} â†’ {n : â„•} â†’ Vect n A â†’ Vect n A
            â‰” {A n} â†¦ xs â†¦ tac rewrite (_ â˜ _) (plus-left-Z ?); exact reverseH nil xs;

let _âˆ˜_ : {A B C : ğ•Œ} â†’ (B â†’ C) â†’ (A â†’ B) â†’ (A â†’ C)
        â‰” {A B C} â†¦ g f x â†¦ g (f x)

let _â‰…_ : ğ•Œ â†’ ğ•Œ â†’ ğ•Œ
        â‰” A B â†¦ (f : A â†’ B) â¨¯ (g : B â†’ A) â¨¯ (g âˆ˜ f â‰¡ id âˆˆ ?) â¨¯ (f âˆ˜ g â‰¡ id âˆˆ ?)

let-type Monoid
     â‰” (A : ğ•Œ)
         â¨¯ (z : A)
         â¨¯ (_+_ : A â†’ A â†’ A)
         â¨¯ ((x : A) â†’ z + x â‰¡ x âˆˆ A)
         â¨¯ ((x : A) â†’ x + z â‰¡ x âˆˆ A)
         â¨¯ ((x y z : A) â†’ x + (y + z) â‰¡ (x + y) + z âˆˆ A)

define Is-Commut-Monoid : ğ•Œ â†’ ğ•Œ
     â‰” A â†¦ (z : A)
         â¨¯ (_+_ : A â†’ A â†’ A)
         â¨¯ ((x : A) â†’ z + x â‰¡ x âˆˆ A)
         â¨¯ ((x : A) â†’ x + z â‰¡ x âˆˆ A)
         â¨¯ ((x y z : A) â†’ x + (y + z) â‰¡ (x + y) + z âˆˆ A)
         â¨¯ ((x y : A) â†’ x + y â‰¡ y + x âˆˆ A)

define-type Commut-Monoid
     â‰” (A : ğ•Œ) â¨¯ Is-Commut-Monoid A

define â„•-Monoid : Monoid
                â‰” tac unfold â˜; exact â„•, Z, _+_ , plus-left-Z, plus-right-Z, plus-assoc;

define â„•-Commut-Monoid : Commut-Monoid
                â‰” â„•, Z, _+_ , plus-left-Z, plus-right-Z, plus-assoc, plus-commut

define test-commut-monoid-solver : (x y : â„•) â†’ x + Z + y â‰¡ y + Z + x âˆˆ â„•
                                 â‰” x y â†¦ tac
                                     normalise-comm-monoid (â˜ â‰¡ _ âˆˆ _) (x y âŠ¦ x + 0 + y) â„•-Commut-Monoid;
                                     normalise-comm-monoid (_ â‰¡ â˜ âˆˆ _) (x y âŠ¦ y + 0 + x) â„•-Commut-Monoid;
                                     exact ?t;

let one : â„•
        â‰” S Z

let two : â„•
        â‰” one + one

let four : â„•
   â‰” two * two
